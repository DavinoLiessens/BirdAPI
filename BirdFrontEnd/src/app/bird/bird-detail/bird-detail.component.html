<div class="page">
    <div class="page-wrapper">
        <div class="page-header">
            <h1>Bird management</h1>
        </div>
        <div class="page-body">
            <div class="p-d-flex p-jc-between p-ai-center">
                <h2>Algemene informatie</h2>
                <button *ngIf="bird && bird.parents !== undefined" pButton pRipple type="button" icon="pi pi-arrow-right" iconPos="right" label="Ga naar stamboom" class="p-button-raised" (click)="goToBirthTree()"></button>
            </div>
            <form *ngIf="birdForm && !(loading$ | async)" [formGroup]="birdForm">
                <div class="form-group-wrapper">
                    <div class="form-group">
                        <label for="ringNumber">Ringnummer</label>
                        <input pInputText type="text" class="form-control" formControlName="ringNumber" id="ringNumber" placeholder="XX123456789XX">
                    </div>
            
                    <div class="form-group">
                        <label for="gender">Geslacht</label>
                        <input pInputText type="text" class="form-control" formControlName="gender" id="gender">
                    </div>
                </div>
        
                <div class="form-group-wrapper">
                    <div class="form-group">
                        <label for="birdType">Type</label>
                        <input pInputText type="text" class="form-control" formControlName="birdType" id="birdType">
                    </div>
    
                    <div class="form-group">
                        <label for="birthDate">Jaartal</label>
                        <input pInputText type="date" class="form-control" formControlName="birthDate" id="birthDate">
                    </div>
                </div>

                <div class="form-group-wrapper">
                    <div class="form-group">
                        <label for="color">Kleur</label>
                        <input pInputText type="text" class="form-control" formControlName="color" id="color">
                    </div>
    
                    <div class="form-group">
                        <label for="cageNumber">Kotnummer</label>
                        <input pInputText type="text" class="form-control" formControlName="cageNumber" id="cageNumber" placeholder="A1">
                    </div>
                </div>

                <div class="form-group-wrapper">
                    <div class="form-group">
                        <label for="breeder">Kweker</label>
                        <input pInputText type="text" class="form-control" formControlName="breeder" id="breeder">
                    </div>
    
                    <div class="form-group">
                        <label for="owner">Eigenaar</label>
                        <p-dropdown *ngIf="owners$ | async" autoWidth="false" [style]="{'width':'100%'}" [options]="owners" optionLabel="name" optionValue="value" formControlName="owner" [placeholder]="ownerFullName" [showClear]="true" [filter]="true" filterBy="name"></p-dropdown>
                    </div>
                </div>

                <div class="form-group-wrapper">
                    <div class="form-group">
                        <label for="description">Omschrijving</label>
                        <textarea pInputTextarea type="text" class="form-control" formControlName="description" id="description" autoResize="autoResize" [rows]="3" [cols]="50"></textarea>
                    </div>
                    <div class="form-group p-jc-center">
                        <div class="p-d-flex p-mt-2">
                            <label class="p-mr-2" [style]="{'width':'50px'}" for="isDead">Dood</label>
                            <p-checkbox formControlName="isDead" binary="true"></p-checkbox>
                        </div>
                    </div>
                </div>
        
                <div class="form-footer">
                    <button pButton type="button" class="p-button-outlined" (click)="goBack()" label="Terug"></button>
                    <button pButton type="submit" (click)="onSubmit()" [disabled]="!birdForm.valid" label="Opslaan"></button>
                </div>
            </form>

            <!-- Parents -->
            <h2>Ouders</h2>
            <div class="p-d-flex p-jc-start">
                <div class="p-d-flex p-flex-column p-mr-3">
                    <label for="father">Vader</label>
                    <input pInputText type="text" [style]="{'width':'200px'}" class="form-control" id="father" placeholder="-" [value]="bird?.parents ? bird.parents.fatherRingNumber : '-'" disabled>
                </div>
        
                <div class="p-d-flex p-flex-column">
                    <label for="mother">Moeder</label>
                    <input pInputText type="text" [style]="{'width':'200px'}" class="form-control" id="mother" placeholder="-" [value]="bird?.parents ? bird.parents.motherRingNumber : '-'" disabled>
                </div>
            </div>

            <!-- Couples -->
            <h2 class="p-mt-5">Koppels</h2>
            <div class="couples">
                <p-table #dt1 [value]="bird?.birdCouples" dataKey="id"
                [rows]="10" [showCurrentPageReport]="true" styleClass="p-datatable-customers p-datatable-gridlines"
                [paginator]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries">
                <ng-template pTemplate="header">
                    <tr>
                        <th>
                            <div class="p-d-flex p-jc-between p-ai-center">
                                Naam
                            </div>
                        </th>
                        <th>
                            <div class="p-d-flex p-jc-between p-ai-center">
                                Vader
                            </div>
                        </th>
                        <th>
                            <div class="p-d-flex p-jc-between p-ai-center">
                                Moeder
                            </div>
                        </th>
                        <th>
                            <div class="p-d-flex p-jc-between p-ai-center">
                                Jaartal
                            </div>
                        </th>
                        <th>
                            <div class="p-d-flex p-jc-between p-ai-center">
                                Ga naar koppel
                            </div>
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-couple>
                    <tr>
                        <td>
                            <p>{{ couple.name }}</p>
                        </td>
                        <td>
                            <p>{{ couple.fatherRingNumber }}</p>
                        </td>
                        <td>
                            <p>{{ couple.motherRingNumber }}</p>
                        </td>
                        <td>
                            <p>{{ couple.startedAt | date: 'MM/yyyy' }}</p>
                        </td>                       
                        <td>
                            <button pButton pRipple type="button" label="Open" class="detail-button" style="margin-left: 5px;" (click)="goToCouple(couple.id)"></button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="7">Geen koppels gevonden.</td>
                    </tr>
                </ng-template>
            </p-table>
            <div class="p-mt-4">
                <c-loader *ngIf="loading$ | async"></c-loader>
            </div>

            <!-- Shows -->
            <div class="p-d-flex p-jc-between p-ai-center">
                <h2 class="p-mt-5">Tentoonstellingen</h2>
                <button pButton pRipple type="button" icon="pi pi-plus" iconPos="left" label="Tentoonstelling" class="p-button-raised" (click)="openCreateBirdShowModel(bird.id)"></button>
            </div>
            <div class="shows">
                <p-table #dt1 [value]="bird?.birdShows" dataKey="id"
                [rows]="10" [showCurrentPageReport]="true" styleClass="p-datatable-customers p-datatable-gridlines"
                [paginator]="true" currentPageReportTemplate="Showing {first} to {last} of {totalRecords} entries">
                <ng-template pTemplate="header">
                    <tr>
                        <th>
                            <div class="p-d-flex p-jc-between p-ai-center">
                                Locatie
                            </div>
                        </th>
                        <th>
                            <div class="p-d-flex p-jc-between p-ai-center">
                                Punten
                            </div>
                        </th>
                        <th>
                            <div class="p-d-flex p-jc-between p-ai-center">
                                Plaats
                            </div>
                        </th>                        
                        <th>
                            <div class="p-d-flex p-jc-between p-ai-center">
                                Opties
                            </div>
                        </th>
                    </tr>
                </ng-template>
                <ng-template pTemplate="body" let-show>
                    <tr>
                        <td>
                            <p>{{ show.location }}</p>
                        </td>
                        <td>
                            <p>{{ show.points }}</p>
                        </td>
                        <td>
                            <p>{{ show.rank }}</p>
                        </td>                      
                        <td>
                            <button pButton pRipple type="button" label="" icon="pi pi-pencil" class="detail-button" style="margin-left: 5px;" (click)="openUpdateBirdShowModel(show.birdId, show.id)"></button>
                        </td>
                    </tr>
                </ng-template>
                <ng-template pTemplate="emptymessage">
                    <tr>
                        <td colspan="7">Geen tentoonstellingen gevonden.</td>
                    </tr>
                </ng-template>
            </p-table>
            <div class="p-mt-4">
                <c-loader *ngIf="loading$ | async"></c-loader>
            </div>
        </div>
    </div>
</div>